<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Chat NodeJS - API</title>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="./css/style.css" />
  </head>
  <body data-spy="scroll" data-target="#myScrollspy" data-offset="15">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-12">
          <h1 class="text-center">Chat NodeJS</h1>
          <h2 class="text-center">How to</h2>
        </div>
      </div>
      <div class="row">
        <nav class="col-md-2 hidden-xs hidden-sm" id="myScrollspy">
          <ul class="nav affix" data-spy="affix" data-offset-top="122">
            <li id="inicio">
              <a href="">Inicio</a>
            </li>
            <li>
              <a href="#api">API</a>
              <ul class="nav">
                <li>
                  <a href="#usuario">Obtener los mensajes de un usuario</a>
                </li>
                <li>
                  <a href="#nuevo">Nuevo mensaje</a>
                </li>
              </ul>
            </li>
          </ul>
        </nav>
        <div class="col-md-10 col-sm-12 col-md-offset-2">
          <div class="row">
            <p>
              La aplicación está desarrollada en <b><i>NodeJS</i></b> y <b><i>Socket.io</i></b> y pretende ser una
              <i>API</i> funcional de un chat con <b>sockets</b> que podemos instalar en cualquier servidor ajeno
              a nuestras aplicaciones y puede ser accesible desde cualquiera de ellas.
            </p>
          </div>
          <div class="row" id="api">
            <h3>API</h3>
            <p>
              Para acceder a la <i>API</i> lo único que debemos hacer es indicar la ruta de nuestra aplicación, indicando
              la ruta de la <i>API</i>. Por ejemplo:
            </p>
            <p>
              <code>http://[host]/api/[método]</code>
            </p>
            <p>
              Las rutas devuelven los datos en JSON, por lo que podemos realizar llamadas <b>AJAX</b>
              desde nuestra aplicación:
            </p>
            <p>
              <pre>
  $.getJSON('http://[host]/api/get-messages/1', function(data){
    // ...
  });
              </pre>
            </p>
          </div>
          <div class="row" id="usuario">
            <h3>Obtener mensajes de un usuario</h3>
            <p>
              Podremos obtener todos los mensajes de un usuario específico pasando el ID como parámetro
              en la ruta:
            </p>
            <p>
              <code>/api/get-messages/:userid</code>
            </p>
            <p>
              Si por ejemplo queremos ver los mensajes del usuario <b>84</b>:
            </p>
            <p>
              <code>/api/get-messages/84</code>
            </p>
            <p>
              Nos devolverá una cadena similar a esta:
            </p>
            <p>
              <pre>
  [
    {
        "_id": "58725c2d9b916e20aa1ab5c7",
        "userid": 84,
        "msg": "Froga",
        "__v": 0,
        "created": "2017-01-08T15:35:09.132Z"
    },
    {
        "_id": "58725c449b916e20aa1ab5c8",
        "userid": 84,
        "msg": "Froga",
        "__v": 0,
        "created": "2017-01-08T15:35:32.811Z"
    }
  ]
              </pre>
            </p>
          </div>
          <div class="row" id="nuevo">
            <h3>Nuevo mensaje</h3>
            <p>
              Para crear un nuevo mensaje debemos hacerlo <u>obligatoriamente</u> desde una llamada a <b>AJAX</b>
              del tipo <b>POST</b>, especificando el <i>userid</i> (ID del usuario) y el <i>msg</i> (el mensaje):
            </p>
            <p>
              <pre>
  $.post('https://[host]/api/new-message',
    {
      userid: 5,
      msg: "Texto del mensaje"
    }
  ).done(function(data){
      console.log(data);
  });
              </pre>
            </p>
          </div>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="./js/api.js"></script>
  </body>
</html>
